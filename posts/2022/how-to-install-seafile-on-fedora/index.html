<!doctype html><html lang=en><head><title>How to install Seafile on Fedora :: /home/gerov</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="How to install Seafile Server 9 Community Edition with MySQL/MariaDB on Fedora, including SystemD Units, Nginx and Let&amp;rsquo; s Encrypt."><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://gerov.eu/posts/2022/how-to-install-seafile-on-fedora/><link rel=stylesheet href=https://gerov.eu/assets/style.css><link rel=stylesheet href=https://gerov.eu/assets/green.css><link rel=apple-touch-icon href=https://gerov.eu/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://gerov.eu/img/favicon/green.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="How to install Seafile on Fedora"><meta property="og:description" content="How to install Seafile Server 9 Community Edition with MySQL/MariaDB on Fedora, including SystemD Units, Nginx and Let&amp;rsquo; s Encrypt."><meta property="og:url" content="https://gerov.eu/posts/2022/how-to-install-seafile-on-fedora/"><meta property="og:site_name" content="/home/gerov"><meta property="og:image" content="https://gerov.eu/img/favicon/green.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:section" content="Linux"><meta property="article:published_time" content="2022-06-30 00:00:00 +0000 UTC"></head><body class=green><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>üï∑Ô∏è /home/gerov</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li><li><a href=/posts>Posts</a></li><li><a href=/tags>Tags</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li><li><a href=/posts>Posts</a></li><li><a href=/tags>Tags</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://gerov.eu/posts/2022/how-to-install-seafile-on-fedora/>How to install Seafile on Fedora</a></h1><div class=post-meta><span class=post-date>2022-06-30
[Updated: 2022-06-30]</span>
<span class=post-reading-time>:: 6 min read (1270 words)</span></div><span class=post-tags>#<a href=https://gerov.eu/tags/linux/>linux</a>&nbsp;
#<a href=https://gerov.eu/tags/seafile/>seafile</a>&nbsp;
#<a href=https://gerov.eu/tags/fedora/>fedora</a>&nbsp;</span>
<img src=/posts/2022/how-to-install-seafile-on-fedora/cover.jpg class=post-cover alt="How to install Seafile on Fedora" title="Cover Image"><div class=post-content><div><p>This tutorial is based on official SeaFile <a href=https://manual.seafile.com/deploy/using_mysql/>documentation</a> and it&rsquo;s adapted for <a href=https://getfedora.org>Fedora 36</a>.</p><h1 id=install-mariadb-server>Install MariaDB Server<a href=#install-mariadb-server class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Install MariaDB server via yum/dnf</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dnf install mariadb-server
</span></span></code></pre></div><p>Enable and start now MariaDB server</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>systemctl enable --now mariadb
</span></span></code></pre></div><h1 id=secure-mariadb-server>Secure MariaDB Server<a href=#secure-mariadb-server class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Prepare MariadB server for production.
In this step we will set MariaDB root password, which will be required from SeaFile Server installation scripts.</p><p>Here is an exampele:</p><pre tabindex=0><code>mysql_secure_installation

NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB
      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!

In order to log into MariaDB to secure it, we&#39;ll need the current
password for the root user. If you&#39;ve just installed MariaDB, and
haven&#39;t set the root password yet, you should just press enter here.

Enter current password for root (enter for none):
OK, successfully used password, moving on...

Setting the root password or using the unix_socket ensures that nobody
can log into the MariaDB root user without the proper authorisation.

You already have your root account protected, so you can safely answer &#39;n&#39;.

Switch to unix_socket authentication [Y/n] n
 ... skipping.

You already have your root account protected, so you can safely answer &#39;n&#39;.

Change the root password? [Y/n] y
New password: [ENTER NEW ROOT PASSWORD HERE]
Re-enter new password: [RE-ENTER NEW ROOT PASSWORD HERE]
Password updated successfully!
Reloading privilege tables..
 ... Success!


By default, a MariaDB installation has an anonymous user, allowing anyone
to log into MariaDB without having to have a user account created for
them.  This is intended only for testing, and to make the installation
go a bit smoother.  You should remove them before moving into a
production environment.

Remove anonymous users? [Y/n] y
 ... Success!

Normally, root should only be allowed to connect from &#39;localhost&#39;.  This
ensures that someone cannot guess at the root password from the network.

Disallow root login remotely? [Y/n] y
 ... Success!

By default, MariaDB comes with a database named &#39;test&#39; that anyone can
access.  This is also intended only for testing, and should be removed
before moving into a production environment.

Remove test database and access to it? [Y/n] y
 - Dropping test database...
 ... Success!
 - Removing privileges on test database...
 ... Success!

Reloading the privilege tables will ensure that all changes made so far
will take effect immediately.

Reload privilege tables now? [Y/n] y
 ... Success!

Cleaning up...

All done!  If you&#39;ve completed all of the above steps, your MariaDB
installation should now be secure.

Thanks for using MariaDB!
</code></pre><h1 id=install-seafile-deps>Install Seafile Deps<a href=#install-seafile-deps class=hanchor arialabel=Anchor>&#8983;</a></h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dnf install wget python3 python3-setuptools python3-pip python3-devel mariadb-devel gcc <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>python3-pillow python3-pylibmc python3-jinja2 python3-sqlalchemy <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>python3-pylibmc python3-ldap python3-mysqlclient python3-pycryptodomex <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>memcached memcached-devel
</span></span></code></pre></div><h1 id=install-python-modules>Install Python modules<a href=#install-python-modules class=hanchor arialabel=Anchor>&#8983;</a></h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pip3 install captcha django-pylibmc django-simple-captcha
</span></span></code></pre></div><h1 id=setup-seafile>Setup SeaFile<a href=#setup-seafile class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Create SeaFile user with home directory /opt/seafile</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>adduser -b /opt seafile
</span></span></code></pre></div><p>Change user to seafile</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>su - seafile
</span></span></code></pre></div><p>Download the install package from the Seafile Download page.
We use Seafile CE version 9.0.6 as an example in the rest of this manual.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>wget https://s3.eu-central-1.amazonaws.com/download.seadrive.org/seafile-server_9.0.6_x86-64.tar.gz
</span></span></code></pre></div><p>Uncompress the package by using tar</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tar xf seafile-server_9.0.6_x86-64.tar.gz
</span></span></code></pre></div><p>Run the installation script</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd seafile-server-9.0.6/
</span></span><span style=display:flex><span>./setup-seafile-mysql.sh
</span></span></code></pre></div><p>You will be asked several questions, including MariaDB password.</p><p>Here is an example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./setup-seafile-mysql.sh
</span></span><span style=display:flex><span>Checking python on this machine ...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>-----------------------------------------------------------------
</span></span><span style=display:flex><span>This script will guide you to setup your seafile server using MySQL.
</span></span><span style=display:flex><span>Make sure you have read seafile server manual at
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        https://download.seafile.com/published/seafile-manual/home.md
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Press ENTER to <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>-----------------------------------------------------------------
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>What is the name of the server? It will be displayed on the client.
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span> - <span style=color:#ae81ff>15</span> letters or digits
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> server name <span style=color:#f92672>]</span> fedora-cloud
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>What is the ip or domain of the server?
</span></span><span style=display:flex><span>For example: www.mycompany.com, 192.168.1.101
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> This server<span style=color:#960050;background-color:#1e0010>&#39;</span>s ip or domain <span style=color:#f92672>]</span> fedora.cloud.local
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Which port <span style=color:#66d9ef>do</span> you want to use <span style=color:#66d9ef>for</span> the seafile fileserver?
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> default <span style=color:#e6db74>&#34;8082&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>-------------------------------------------------------
</span></span><span style=display:flex><span>Please choose a way to initialize seafile databases:
</span></span><span style=display:flex><span>-------------------------------------------------------
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> Create new ccnet/seafile/seahub databases
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2<span style=color:#f92672>]</span> Use existing ccnet/seafile/seahub databases
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> <span style=color:#ae81ff>1</span> or <span style=color:#ae81ff>2</span> <span style=color:#f92672>]</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>What is the host of mysql server?
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> default <span style=color:#e6db74>&#34;localhost&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>What is the port of mysql server?
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> default <span style=color:#e6db74>&#34;3306&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>What is the password of the mysql root user?
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> root password <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>verifying password of user root ...  <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Enter the name <span style=color:#66d9ef>for</span> mysql user of seafile. It would be created <span style=color:#66d9ef>if</span> not exists.
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> default <span style=color:#e6db74>&#34;seafile&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Enter the password <span style=color:#66d9ef>for</span> mysql user <span style=color:#e6db74>&#34;seafile&#34;</span>:
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> password <span style=color:#66d9ef>for</span> seafile <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Enter the database name <span style=color:#66d9ef>for</span> ccnet-server:
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> default <span style=color:#e6db74>&#34;ccnet-db&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Enter the database name <span style=color:#66d9ef>for</span> seafile-server:
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> default <span style=color:#e6db74>&#34;seafile-db&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Enter the database name <span style=color:#66d9ef>for</span> seahub:
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> default <span style=color:#e6db74>&#34;seahub-db&#34;</span> <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>---------------------------------
</span></span><span style=display:flex><span>This is your configuration
</span></span><span style=display:flex><span>---------------------------------
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    server name:            fedora-cloud
</span></span><span style=display:flex><span>    server ip/domain:       fedora.cloud.local
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    seafile data dir:       /opt/seafile/seafile-data
</span></span><span style=display:flex><span>    fileserver port:        <span style=color:#ae81ff>8082</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    database:               create new
</span></span><span style=display:flex><span>    ccnet database:         ccnet-db
</span></span><span style=display:flex><span>    seafile database:       seafile-db
</span></span><span style=display:flex><span>    seahub database:        seahub-db
</span></span><span style=display:flex><span>    database user:          seafile
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>---------------------------------
</span></span><span style=display:flex><span>Press ENTER to <span style=color:#66d9ef>continue</span>, or Ctrl-C to abort
</span></span><span style=display:flex><span>---------------------------------
</span></span><span style=display:flex><span>Generating ccnet configuration ...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Generating seafile configuration ...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>Generating seahub configuration ...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>----------------------------------------
</span></span><span style=display:flex><span>Now creating ccnet database tables ...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>----------------------------------------
</span></span><span style=display:flex><span>----------------------------------------
</span></span><span style=display:flex><span>Now creating seafile database tables ...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>----------------------------------------
</span></span><span style=display:flex><span>----------------------------------------
</span></span><span style=display:flex><span>Now creating seahub database tables ...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>----------------------------------------
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>creating seafile-server-latest symbolic link ...  <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>-----------------------------------------------------------------
</span></span><span style=display:flex><span>Your seafile server configuration has been finished successfully.
</span></span><span style=display:flex><span>-----------------------------------------------------------------
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>run seafile server:     ./seafile.sh <span style=color:#f92672>{</span> start | stop | restart <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>run seahub  server:     ./seahub.sh  <span style=color:#f92672>{</span> start &lt;port&gt; | stop | restart &lt;port&gt; <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>-----------------------------------------------------------------
</span></span><span style=display:flex><span>If you are behind a firewall, remember to allow input/output of these tcp ports:
</span></span><span style=display:flex><span>-----------------------------------------------------------------
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>port of seafile fileserver:   <span style=color:#ae81ff>8082</span>
</span></span><span style=display:flex><span>port of seahub:               <span style=color:#ae81ff>8000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>When problems occur, Refer to
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        https://download.seafile.com/published/seafile-manual/home.md
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> information.
</span></span></code></pre></div><p>Start Seafile server via scripts and setup admin user</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./seafile.sh start
</span></span><span style=display:flex><span>./seahub.sh start
</span></span><span style=display:flex><span>Starting seahub at port <span style=color:#ae81ff>8000</span> ...
</span></span><span style=display:flex><span>----------------------------------------
</span></span><span style=display:flex><span>It<span style=color:#e6db74>&#39;s the first time you start the seafile server. Now let&#39;</span>s create the admin account
</span></span><span style=display:flex><span>----------------------------------------
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>What is the email <span style=color:#66d9ef>for</span> the admin account?
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> admin email <span style=color:#f92672>]</span> tg@local.local
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>What is the password <span style=color:#66d9ef>for</span> the admin account?
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> admin password <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Enter the password again:
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> admin password again <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>----------------------------------------
</span></span><span style=display:flex><span>Successfully created seafile admin
</span></span><span style=display:flex><span>----------------------------------------
</span></span></code></pre></div><p>Stop SeaFile and SeaHub</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>./seafile.sh stop
</span></span><span style=display:flex><span>./seahub.sh stop
</span></span></code></pre></div><h1 id=create-systemd-units-to-start-seafile-at-boot>Create SystemD units to start Seafile at boot<a href=#create-systemd-units-to-start-seafile-at-boot class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Note: Exit from user seafile, commands below requires root privileges.</p><p>Create SeaFile Unit</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>vi /etc/systemd/system/seafile.service
</span></span></code></pre></div><p>The content of the file is:</p><pre tabindex=0><code>[Unit]
Description=Seafile
After=network.target mariadb.service

[Service]
Type=forking
ExecStart=/opt/seafile/seafile-server-latest/seafile.sh start
ExecStop=/opt/seafile/seafile-server-latest/seafile.sh stop
LimitNOFILE=infinity
User=seafile
Group=seafile

[Install]
WantedBy=multi-user.target
</code></pre><p>Create SeaHub Unit:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>vi /etc/systemd/system/seahub.service
</span></span></code></pre></div><p>The content of the file is:</p><pre tabindex=0><code>[Unit]
Description=Seafile hub
After=network.target seafile.service

[Service]
Type=forking
ExecStart=/opt/seafile/seafile-server-latest/seahub.sh start
ExecStop=/opt/seafile/seafile-server-latest/seahub.sh stop
User=seafile
Group=seafile

[Install]
WantedBy=multi-user.target
</code></pre><p>Enable and start seafile and seahub:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>systemctl enable --now seafile.service
</span></span><span style=display:flex><span>systemctl enable --now seahub.service
</span></span></code></pre></div><h1 id=setup-nginx-as-reverse-proxy>Setup Nginx as Reverse Proxy<a href=#setup-nginx-as-reverse-proxy class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Install Nginx</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dnf install nginx
</span></span></code></pre></div><p>Enable and start Nginx service</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>systemctl enable --now nginx
</span></span></code></pre></div><p>Allow HTTP (80/tcp) and HTTPS (443/tcp) in Firewall</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>firewall-cmd --add-service<span style=color:#f92672>={</span>http,https<span style=color:#f92672>}</span> --permanent
</span></span><span style=display:flex><span>firewall-cmd --reload
</span></span></code></pre></div><p>If SELinux is enabled on your host, allow HTTPD scripts and modules to connect to the network.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>setsebool -P httpd_can_network_connect <span style=color:#ae81ff>1</span>
</span></span></code></pre></div><p>Create Nginx config file for seafile domain:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>vi /etc/nginx/conf.d/seafile.conf
</span></span></code></pre></div><p>Copy the following sample Nginx config file into the just created seafile.conf and modify the content to fit your needs:</p><pre tabindex=0><code>log_format seafileformat &#39;$http_x_forwarded_for $remote_addr [$time_local] &#34;$request&#34; $status $body_bytes_sent &#34;$http_referer&#34; &#34;$http_user_agent&#34; $upstream_response_time&#39;;

server {
    listen 80;
    server_name seafile.example.com;

    proxy_set_header X-Forwarded-For $remote_addr;

    location / {
         proxy_pass         http://127.0.0.1:8000;
         proxy_set_header   Host $host;
         proxy_set_header   X-Real-IP $remote_addr;
         proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
         proxy_set_header   X-Forwarded-Host $server_name;
         proxy_read_timeout  1200s;

         # used for view/edit office file via Office Online Server
         client_max_body_size 0;

         access_log      /var/log/nginx/seahub.access.log seafileformat;
         error_log       /var/log/nginx/seahub.error.log;
    }
    location /seafhttp {
        rewrite ^/seafhttp(.*)$ $1 break;
        proxy_pass http://127.0.0.1:8082;
        client_max_body_size 0;
        proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;

        proxy_connect_timeout  36000s;
        proxy_read_timeout  36000s;
        proxy_send_timeout  36000s;

        send_timeout  36000s;

        access_log      /var/log/nginx/seafhttp.access.log seafileformat;
        error_log       /var/log/nginx/seafhttp.error.log;
    }
    location /media {
        root /opt/seafile/seafile-server-latest/seahub;
    }
}
</code></pre><p>Reload nginx configuration</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>systemctl reload nginx
</span></span></code></pre></div><h1 id=issue-lets-encrypt-ssl>Issue Lets Encrypt SSL<a href=#issue-lets-encrypt-ssl class=hanchor arialabel=Anchor>&#8983;</a></h1><p>Install certbot:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>dnf install python3-certbot python3-certbot-nginx
</span></span></code></pre></div><p>Issue LetsEncrypt SSL and auto deploy it in nginx:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>certbot --nginx
</span></span></code></pre></div><p>References: <a href=https://manual.seafile.com/deploy/>SeaFile Deploy Manual</a></p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://gerov.eu/posts/2022/how-to-configure-bridge-on-bond-with-networkmanager/><span class=button__icon>‚Üê</span>
<span class=button__text>How to Configure Bridge on Bond With NetworkManager</span></a></span>
<span class="button next"><a href=https://gerov.eu/posts/unlock-luks-encrypted-fs-remotetly-via-ssh/><span class=button__text>Unlock LUKs encrypted root filesystem remotely via SSH (RHEL 8/CentOS 8)</span>
<span class=button__icon>‚Üí</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>Copyright 2022 Tsvetan Gerov | All Content CC-BY-SA</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://gerov.eu/assets/main.js></script>
<script src=https://gerov.eu/assets/prism.js></script></div></body></html>